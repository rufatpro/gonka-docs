# 密钥管理架构

本文档描述了 Gonka 网络的综合密钥管理架构，这是一个去中心化 AI 基础设施，需要通过基于角色的密钥分离来确保强大的安全性。

## 概述

Gonka 网络实现了**基于角色的密钥管理系统**，将自动化功能与高风险手动审批分离。此架构确保没有单个密钥控制所有网络操作，提供增强的安全性和操作灵活性。

!!! info "快速设置"
    要立即部署，请参阅[快速开始指南](/host/quickstart/)。本文档重点介绍理解完整的密钥管理架构和安全模型。

## 启动时的密钥架构（v0）

在网络启动时，主机使用**三密钥系统**：

| 密钥类型 | 用途 | 存储 | 算法 | 使用 |
|----------|------|------|------|------|
| **账户密钥** | 主控制与权限 | 安全本地机器 | SECP256K1 | 手动高风险操作 |
| **ML 运营密钥** | 自动化 AI 交易 | 服务器加密 | SECP256K1 | 自动化 ML 工作流 |
| **共识密钥** | 区块验证与共识 | TMKMS 温存储 | ED25519 | 网络共识参与 |

## 安全模型

### 账户密钥（冷钱包）- **关键**
- **控制**：主密钥，授予所有其他密钥的权限
- **安全**：必须离线存储在安全、隔离的机器上
- **使用**：仅用于授予权限和验证者注册
- **恢复**：由助记词保护 - **如果丢失，所有访问将永久丢失**

### ML 运营密钥（温钱包）
- **控制**：由账户密钥授权，用于 ML 特定交易
- **安全**：服务器上的加密文件，通过程序访问
- **使用**：自动化交易（推理请求、证明提交、奖励）
- **恢复**：可随时由账户密钥轮换/撤销

### 共识密钥（TMKMS - 温存储）
- **控制**：由安全的 TMKMS 服务管理
- **安全**：温存储，具有防双签功能
- **使用**：区块验证和网络共识参与
- **恢复**：可由账户密钥或授权代表轮换
  
## 最佳实践

### 安全指南

1. **账户密钥保护** 
    - **存储**：安全本地机器，加密存储，最小化互联网暴露
        - *安全本地机器*：专用计算机，访问受限，不用于日常浏览/邮件，理想情况下隔离或网络连接有限
    - **密钥环后端**：使用 `file` 或 `os` 密钥环后端进行安全本地存储
    - **密码短语**：使用强、唯一的密码短语保护密钥环
    - **备份**：在安全位置维护助记词的离线备份
    - **使用**：绝不用于常规操作 - 仅用于授予权限和验证者操作

2. **硬件钱包支持**
    - **当前状态**：网络启动时不支持 
    - **关键**：始终保存并安全存储你的助记词作为最终恢复方法

3. **ML 运营密钥管理**
     - **密钥环后端**：必须使用 `file` 密钥环后端进行基于服务器的存储，支持程序访问
     - **安全**：在服务器上加密存储，强密码短语保护
     - **轮换**：使用账户密钥授权定期轮换 ML 运营密钥
     - **访问**：在保持静态加密的同时，为容器启用程序访问

4. **运营安全**
     - 为所有密钥实施适当的备份和恢复程序
     - 在生产部署前在安全环境中测试密钥恢复程序
     - 监控和审计密钥使用模式

### 恢复程序
1. **账户密钥丢失**：**关键** - 没有助记词无法恢复
2. **ML 运营密钥丢失**：创建新密钥并使用账户密钥重新授权
3. **共识密钥丢失**：使用账户密钥授权轮换共识密钥

## 多重签名组（v1 高级）

```
公司参与者：
├── 账户密钥 → 安全存储 + 多重签名
├── ML 运营密钥 → 自动化 AI 工作负载
├── 治理组 → 协议投票的多重签名
│   ├── CEO/创始人
│   ├── CTO/技术负责人  
│   └── 运营负责人
└── 财务组（可选）→ 高价值转账的独立多重签名
    ├── CEO/创始人
    ├── CFO/财务负责人
    └── 董事会成员
```

---

!!! warning "生产部署"
    在生产部署之前，确保你理解完整的密钥管理工作流，并在安全环境中测试了密钥恢复程序。

**需要帮助？** 加入我们的[Discord 服务器](https://discord.com/invite/RADwCT2U6R) 获取密钥管理、安全担忧或技术问题的帮助。
